<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arctic Ice Melt Visualization</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>

    <div id="explanation">
        <h2>A Heated Globe - Melting of the Arctic Ice</h2>
        <p>This visualization shows the decline in Arctic sea ice minimum extent from 1979 to 2024. The "ice flakes" shrink as the extent decreases.</p>
        <p>Arctic Sea Ice Minimum levels refer to the amount of sea ice in the arctic during the warmest time of the year, usually september.</p>
        <p>Arctic sea ice minimum levels are an important metric to track global warming. It also puts the life of animals such as polar bears and walruses at risk, who depend on the sea ice for survival.</p>
        
    </div>

    <div id="canvas-wrapper">
        </div>

    <div id="mobile-controls">
        <button id="prev-5-year" aria-label="Previous 5 Years">◀◀ 5yr</button>
        <button id="prev-year" aria-label="Previous Year">◀ Prev</button>
        <button id="next-year" aria-label="Next Year">Next ▶</button>
        <button id="next-5-year" aria-label="Next 5 Years">5yr ▶▶</button>
    </div>
    
    <p class="tooltip">Use ← and → arrows on your keyboard to jump one year<br>press ctrl ← or → to jump 5 years</p>

    <footer>
        <p>Data source: <a href="https://nsidc.org/data/seaice_index/" target="_blank" rel="noopener noreferrer">NSIDC Sea Ice Index</a></p>
        <p>This project was created as a part of the Future Fridays workshop initiative by Data Visualization Society and Infogr8.</p>
        <p>Created by Therese Bosrup</p>
        <div class="social-icons">
            <a href="https://github.com/theboska" aria-label="GitHub Profile" target="_blank">
                <i class="fa-brands fa-github"></i>
            </a>
            <a href="https://instagram.com/unsupervised.dreams" aria-label="Instagram Profile" target="_blank">
                <i class="fa-brands fa-instagram"></i>
            </a>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>

    <script src="sketch.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {


            // --- Mobile Controls Logic ---
            const prevBtn = document.getElementById('prev-year');
            const nextBtn = document.getElementById('next-year');
            const prev5Btn = document.getElementById('prev-5-year'); // <-- ADDED
            const next5Btn = document.getElementById('next-5-year'); // <-- ADDED

// Updated function to handle step amount
            function triggerStep(direction, step = 1) {
                // Access global vars from sketch.js
                if (window.transitioning) return; // Prevent spamming
                window.queuedSteps = step; // <-- UPDATED
                window.transitionDirection = direction;
                window.transitioning = true;
                window.transitionProgress = 0;
                window.transitionDelay = 0;
            }
            // Update existing listeners
            prevBtn.addEventListener('click', () => triggerStep(-1, 1));
            nextBtn.addEventListener('click', () => triggerStep(1, 1));

            // Add new listeners for 5-year jump
            prev5Btn.addEventListener('click', () => triggerStep(-1, 5));
            next5Btn.addEventListener('click', () => triggerStep(1, 5));
            
            // --- Tooltip Update Logic ---
            // This script enhances your 'draw' function to update the tooltip
            const tooltip = document.querySelector('.tooltip');
            if (tooltip && typeof window.draw === 'function' && typeof window.years !== 'undefined') {
                
                const originalDraw = window.draw; // Save the original draw function
                
                // Create a new draw function
                window.draw = function() {
                    originalDraw.apply(this, arguments); // Run the original draw
                    
                    // Add our new functionality
                    if (!window.transitioning) { // Only update when stable
                        const data = window.years[window.yearIndex];
                        tooltip.textContent = `Year: ${data.year} | Extent: ${data.extent.toFixed(3)} Mkm²`;
                    }
                }
            }
        });
    </script>

</body>
</html>